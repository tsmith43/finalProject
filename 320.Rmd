---
title: "Shark Attacks are Rising"
author: "Nadiya Klymenko, Trevor Smith"
output: html_document
---

Introduction:



Required Tools:



1. Getting Started
  We need to first download the dataset that we are planning to analyze. You can find this dataset at https://www.kaggle.com/teajay/global-shark-attacks/version/7 
  Filter out the reported part of the message. If it doesn't fit the format DAY-MONTH-YEAR we don't care about it and it is deleted from our information. 
  
  Remember to replace all of the blank data point with NA 
```{r}
library(tidyverse)
library(ggplot2)

shark_data <- read.csv(file="/Users/trevorsmith/Desktop/attacks.csv", na.strings=c("","NA"))

aus_shark_data <- shark_data %>% 
  separate(Date, into=c("Day","Month"),  "-") %>%
  filter(Month == "Jan" | Month == "Feb" | Month == "Mar" | Month == "Apr" | Month == "May" | Month == "Jun" | Month == "Jul" | Month == "Aug" | Month == "Sep"
         | Month == "Oct" | Month == "Nov" | Month == "Dec", Year >= 1900, Year < 2018) %>% 
  
  select(Month, Year, Type, Country, Area, Activity, Injury, Fatal = Fatal..Y.N.)
  
s <- nrow(aus_shark_data)
s
aus_shark_data

```
  


```{r}
months <- aus_shark_data %>%
  group_by(Year) %>%
  summarize(numOfAttacks = n()) %>%
  ggplot(aes(x=Year, y=numOfAttacks)) + geom_bar(stat = "identity", color = "black", fill = "navyblue") 

months
```
  
  
  
  
  
```{r}
months <- aus_shark_data %>%
  group_by(Month) %>%
  summarize(numOfAttacks = n()) %>%
  arrange(desc(Month)) %>%
  ggplot(aes(x=Month, y=numOfAttacks)) + geom_bar(stat = "identity", color = "black", fill = "navyblue") 



months
```
  
  Activity vs #Attacks
  Ml: Predict number of attacks in a month
  HT: Does month impact # of attacks

  
  
```{r}
testing_data <- aus_shark_data %>% 
  group_by(Activity)
# To get the number of flights per day

test <- summarize(testing_data, num = n()) %>%
  arrange(desc(num)) %>%
  filter( num >= 250) %>% 
  mutate(Activity=replace(Activity, is.na(Activity), "Unknown")) %>%
  ggplot(aes(x = Activity, y = num)) + geom_bar(stat = "identity", fill = "red")

test

```
  
  
  
  
```{r}
newData <- aus_shark_data %>%
  group_by(Country) %>%
  summarize(numOfAttacks = n()) %>%
  arrange(desc(numOfAttacks)) %>%
  head() %>% 
  summarize(lol = sum(numOfAttacks), numOfAttacks)

s <- newData$lol

face <- aus_shark_data %>%
  group_by(Year, Country) %>%
  filter(Country == "USA" | Country == "AUSTRALIA" | Country == "SOUTH AFRICA" | Country == "BRAZIL" | Country == "NEW ZEALAND" | Country == "BAHAMAS") %>%
  summarize(numOfAttacks =n()) %>%
  ggplot(aes(x=Year, y=numOfAttacks)) + geom_bar(stat = "identity", color = "black", fill = "navyblue")+ facet_grid(Country ~ ., scales="free") + geom_smooth(method = lm, color = "pink")


f <- aus_shark_data %>%
  group_by(Year, Country) %>%
  filter(Country == "USA" | Country == "AUSTRALIA" | Country == "SOUTH AFRICA" | Country == "BRAZIL" | Country == "NEW ZEALAND" | Country == "BAHAMAS") %>%
  summarize(numOfAttacks = n()) %>%
  ggplot(aes(x=Year, y=numOfAtttacks)) + geom_bar(stat = "identity", color = "black", fill = "navyblue")+ facet_grid(Country ~ .) + geom_smooth(method = lm, color = "pink")

face
f
```
  
  
  
  
  Need to make the data easier to read 
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
```{r}

std_month <- aus_shark_data %>%
  group_by(Year, Month) %>%
  summarize(number = n()) %>% 
  group_by(Month) %>%
  summarize(n = mean(number)) %>%
  ggplot(aes(x=Month, y = sd(n))) + geom_point()

avg_month <- aus_shark_data %>%
  group_by(Year, Month) %>%
  summarize(number = n()) %>%
  group_by(Month) %>%
  summarize(n = mean(number)) %>%
  ggplot(aes(x=Month, y = n, group = 1), levels = month.abb) + geom_point() + geom_line() +  scale_x_discrete(limits = month.abb)




avg_month

```
  
  
  
  
  
  
  
  
  
  
  
  